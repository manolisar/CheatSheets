<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Microsoft Python in Excel Cheat Sheet - Professional Reference</title>
    <meta name="description" content="Comprehensive cheat sheet for Microsoft Python in Excel - PY() function, xl() data access, visualizations, and business automation workflows.">
    <meta name="keywords" content="Python in Excel, PY function, xl function, Microsoft 365, Excel automation, data analysis, business intelligence">
    <style>
        /* Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Helvetica Neue', Arial, sans-serif;
            font-size: 9px;
            line-height: 1.4;
            color: #000;
            background: #fff;
            -webkit-font-smoothing: antialiased;
        }

        /* Container and Layout */
        .container {
            max-width: 100%;
            padding: 20px;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 0 auto;
        }

        /* Header */
        .header {
            grid-column: 1 / -1;
            text-align: center;
            margin-bottom: 20px;
            padding: 20px;
            background: linear-gradient(135deg, #1e3a8a, #1e40af, #3b82f6);
            color: white;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
        }

        .header-content {
            position: relative;
            z-index: 2;
        }

        .header h1 {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 8px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            font-size: 14px;
            opacity: 0.9;
            font-weight: 500;
        }

        .header-stats {
            display: flex;
            justify-content: center;
            gap: 24px;
            margin-top: 12px;
            font-size: 12px;
        }

        .stat {
            text-align: center;
        }

        .stat-number {
            display: block;
            font-size: 18px;
            font-weight: 700;
        }

        /* Sections */
        .section {
            background: #fff;
            border: 1px solid #e5e5ea;
            overflow: hidden;
            break-inside: avoid;
            page-break-inside: avoid;
            margin-bottom: 20px;
        }

        .section-header {
            background: #007AFF;
            color: white;
            padding: 12px 16px;
            font-weight: 600;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .section-content {
            padding: 16px;
        }

        /* Command Groups */
        .command-group {
            margin-bottom: 16px;
        }

        .command-group:last-child {
            margin-bottom: 0;
        }

        .group-title {
            font-weight: 600;
            font-size: 10px;
            color: #007AFF;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            border-bottom: 1px solid #f0f0f0;
            padding-bottom: 4px;
        }

        /* Commands */
        .command {
            display: flex;
            margin-bottom: 6px;
            align-items: flex-start;
            gap: 8px;
        }

        .command:last-child {
            margin-bottom: 0;
        }

        .command-syntax {
            background: #2d3748;
            color: #68d391;
            padding: 3px 6px;
            font-family: 'SF Mono', Consolas, monospace;
            font-size: 8px;
            white-space: nowrap;
            min-width: fit-content;
            border-radius: 3px;
        }

        .command-description {
            color: #3c3c43;
            font-size: 8px;
            flex: 1;
            line-height: 1.3;
        }

        /* Code Blocks */
        .code-block {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            padding: 10px;
            margin: 8px 0;
            font-family: 'SF Mono', Consolas, monospace;
            font-size: 7px;
            line-height: 1.4;
            border-radius: 4px;
            overflow-x: auto;
        }

        .code-block code {
            color: #495057;
        }

        /* Examples */
        .example {
            background: #f0f9ff;
            border-left: 3px solid #007AFF;
            padding: 10px;
            margin: 8px 0;
            font-size: 8px;
        }

        .example-title {
            font-weight: 600;
            color: #007AFF;
            margin-bottom: 4px;
        }

        /* Tips */
        .tip {
            background: #fffbeb;
            border-left: 3px solid #f59e0b;
            padding: 8px;
            margin: 8px 0;
            font-size: 8px;
        }

        .tip strong {
            color: #d97706;
        }

        /* Warnings */
        .warning {
            background: #fef2f2;
            border-left: 3px solid #ef4444;
            padding: 8px;
            margin: 8px 0;
            font-size: 8px;
        }

        .warning strong {
            color: #dc2626;
        }

        /* Key Combinations */
        .key {
            background: #f3f4f6;
            border: 1px solid #d1d5db;
            padding: 2px 6px;
            font-family: 'SF Mono', Consolas, monospace;
            font-size: 7px;
            border-radius: 3px;
            white-space: nowrap;
        }

        /* Workflow Steps */
        .workflow {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            padding: 10px;
            margin: 8px 0;
            border-radius: 4px;
        }

        .workflow-title {
            font-weight: 600;
            font-size: 9px;
            color: #1e40af;
            margin-bottom: 6px;
        }

        .workflow ol {
            margin-left: 12px;
            font-size: 8px;
        }

        .workflow li {
            margin-bottom: 3px;
            line-height: 1.3;
        }

        /* Lists */
        ul, ol {
            margin-left: 12px;
        }

        li {
            margin-bottom: 2px;
            font-size: 8px;
            line-height: 1.3;
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .container {
                grid-template-columns: repeat(2, 1fr);
                gap: 16px;
                padding: 16px;
            }
        }

        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
                gap: 12px;
                padding: 12px;
            }
        }

        /* Print Styles */
        @media print {
            body {
                font-size: 8px;
                margin: 0;
                padding: 0;
            }

            .container {
                padding: 0.3in;
                gap: 10px;
                max-width: none;
            }

            .header {
                margin-bottom: 15px;
                padding: 15px;
            }

            .header h1 {
                font-size: 20px;
            }

            .header p {
                font-size: 11px;
            }

            .section {
                margin-bottom: 12px;
                break-inside: avoid;
                page-break-inside: avoid;
            }

            .command-group {
                break-inside: avoid;
                page-break-inside: avoid;
            }

            .code-block {
                font-size: 6px;
            }

            .header-stats {
                font-size: 10px;
            }

            .stat-number {
                font-size: 14px;
            }
        }

        /* Accessibility */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-content">
                <h1>üêç Microsoft Python in Excel</h1>
                <p>Native Python integration for advanced analytics and automation</p>
                <div class="header-stats">
                    <div class="stat">
                        <span class="stat-number">120+</span>
                        <span>Commands</span>
                    </div>
                    <div class="stat">
                        <span class="stat-number">12</span>
                        <span>Categories</span>
                    </div>
                    <div class="stat">
                        <span class="stat-number">25+</span>
                        <span>Libraries</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Getting Started -->
        <div class="section">
            <div class="section-header">Getting Started</div>
            <div class="section-content">
                <div class="command-group">
                    <div class="group-title">Requirements</div>
                    <div class="command">
                        <span class="command-syntax">Microsoft 365</span>
                        <span class="command-description">Business or Enterprise subscription required</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">Excel for Web</span>
                        <span class="command-description">Python currently available in web version only</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">Internet</span>
                        <span class="command-description">Cloud execution requires active connection</span>
                    </div>
                </div>

                <div class="command-group">
                    <div class="group-title">Enable Python</div>
                    <div class="command">
                        <span class="command-syntax">Insert > Python</span>
                        <span class="command-description">Add Python cell to worksheet</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">=PY()</span>
                        <span class="command-description">Create Python cell with formula</span>
                    </div>
                </div>

                <div class="example">
                    <div class="example-title">Basic Python Cell</div>
                    <div class="code-block">
<code>=PY(
import pandas as pd
data = [1, 2, 3, 4, 5]
sum(data)
)</code>
                    </div>
                </div>
            </div>
        </div>

        <!-- Core Functions -->
        <div class="section">
            <div class="section-header">Core Functions</div>
            <div class="section-content">
                <div class="command-group">
                    <div class="group-title">PY() Function</div>
                    <div class="command">
                        <span class="command-syntax">=PY(code)</span>
                        <span class="command-description">Execute Python code in Excel cell</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">=PY(variable)</span>
                        <span class="command-description">Reference Python variable from another cell</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">=PY(df)</span>
                        <span class="command-description">Output DataFrame as Excel range</span>
                    </div>
                </div>

                <div class="command-group">
                    <div class="group-title">xl() Function</div>
                    <div class="command">
                        <span class="command-syntax">xl("A1:C10")</span>
                        <span class="command-description">Import Excel range as DataFrame</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">xl("Sheet1!A1:C10")</span>
                        <span class="command-description">Import from specific worksheet</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">xl("Table1")</span>
                        <span class="command-description">Import Excel table by name</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">xl("A1:C10", headers=True)</span>
                        <span class="command-description">Import with first row as headers</span>
                    </div>
                </div>

                <div class="example">
                    <div class="example-title">Data Import Example</div>
                    <div class="code-block">
<code>=PY(
df = xl("A1:E100", headers=True)
df.describe()
)</code>
                    </div>
                </div>
            </div>
        </div>

        <!-- Data Manipulation -->
        <div class="section">
            <div class="section-header">Data Operations</div>
            <div class="section-content">
                <div class="command-group">
                    <div class="group-title">Basic Operations</div>
                    <div class="command">
                        <span class="command-syntax">df.head()</span>
                        <span class="command-description">Show first 5 rows</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">df.tail()</span>
                        <span class="command-description">Show last 5 rows</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">df.shape</span>
                        <span class="command-description">Get dimensions (rows, columns)</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">df.info()</span>
                        <span class="command-description">Data types and memory usage</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">df.describe()</span>
                        <span class="command-description">Statistical summary</span>
                    </div>
                </div>

                <div class="command-group">
                    <div class="group-title">Filtering & Selection</div>
                    <div class="command">
                        <span class="command-syntax">df['column']</span>
                        <span class="command-description">Select single column</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">df[['col1', 'col2']]</span>
                        <span class="command-description">Select multiple columns</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">df[df['col'] > 100]</span>
                        <span class="command-description">Filter rows by condition</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">df.query('col > 100')</span>
                        <span class="command-description">Query with string expression</span>
                    </div>
                </div>

                <div class="example">
                    <div class="example-title">Sales Analysis</div>
                    <div class="code-block">
<code>=PY(
sales = xl("A1:D100", headers=True)
high_sales = sales[sales['Amount'] > 1000]
high_sales.groupby('Region').sum()
)</code>
                    </div>
                </div>
            </div>
        </div>

        <!-- Visualizations -->
        <div class="section">
            <div class="section-header">Charts & Visualizations</div>
            <div class="section-content">
                <div class="command-group">
                    <div class="group-title">Matplotlib Charts</div>
                    <div class="command">
                        <span class="command-syntax">plt.plot(x, y)</span>
                        <span class="command-description">Line chart</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">plt.bar(x, y)</span>
                        <span class="command-description">Bar chart</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">plt.scatter(x, y)</span>
                        <span class="command-description">Scatter plot</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">plt.hist(data)</span>
                        <span class="command-description">Histogram</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">plt.pie(values)</span>
                        <span class="command-description">Pie chart</span>
                    </div>
                </div>

                <div class="command-group">
                    <div class="group-title">Pandas Plotting</div>
                    <div class="command">
                        <span class="command-syntax">df.plot()</span>
                        <span class="command-description">Default line plot</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">df.plot(kind='bar')</span>
                        <span class="command-description">Bar chart from DataFrame</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">df.plot.scatter(x, y)</span>
                        <span class="command-description">Scatter plot with column names</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">df.boxplot()</span>
                        <span class="command-description">Box plot for all columns</span>
                    </div>
                </div>

                <div class="example">
                    <div class="example-title">Monthly Trends Chart</div>
                    <div class="code-block">
<code>=PY(
import matplotlib.pyplot as plt
data = xl("A1:B13", headers=True)
plt.figure(figsize=(10, 6))
plt.plot(data['Month'], data['Sales'])
plt.title('Monthly Sales Trend')
plt.xlabel('Month')
plt.ylabel('Sales ($)')
plt.xticks(rotation=45)
plt.tight_layout()
plt.show()
)</code>
                    </div>
                </div>
            </div>
        </div>

        <!-- Statistical Analysis -->
        <div class="section">
            <div class="section-header">Statistics & Analysis</div>
            <div class="section-content">
                <div class="command-group">
                    <div class="group-title">Descriptive Statistics</div>
                    <div class="command">
                        <span class="command-syntax">df.mean()</span>
                        <span class="command-description">Calculate column means</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">df.median()</span>
                        <span class="command-description">Calculate column medians</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">df.std()</span>
                        <span class="command-description">Standard deviation</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">df.corr()</span>
                        <span class="command-description">Correlation matrix</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">df.value_counts()</span>
                        <span class="command-description">Count unique values</span>
                    </div>
                </div>

                <div class="command-group">
                    <div class="group-title">Grouping & Aggregation</div>
                    <div class="command">
                        <span class="command-syntax">df.groupby('col').sum()</span>
                        <span class="command-description">Group by column and sum</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">df.groupby('col').agg({'col2': 'mean'})</span>
                        <span class="command-description">Custom aggregation</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">df.pivot_table()</span>
                        <span class="command-description">Create pivot table</span>
                    </div>
                </div>

                <div class="example">
                    <div class="example-title">Regional Performance Analysis</div>
                    <div class="code-block">
<code>=PY(
import numpy as np
sales = xl("A1:F1000", headers=True)
summary = sales.groupby('Region').agg({
    'Sales': ['sum', 'mean', 'count'],
    'Profit': 'sum'
}).round(2)
summary
)</code>
                    </div>
                </div>
            </div>
        </div>

        <!-- Available Libraries -->
        <div class="section">
            <div class="section-header">Available Libraries</div>
            <div class="section-content">
                <div class="command-group">
                    <div class="group-title">Data & Analytics</div>
                    <div class="command">
                        <span class="command-syntax">pandas</span>
                        <span class="command-description">Data manipulation and analysis</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">numpy</span>
                        <span class="command-description">Numerical computing</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">scipy</span>
                        <span class="command-description">Scientific computing</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">statsmodels</span>
                        <span class="command-description">Statistical modeling</span>
                    </div>
                </div>

                <div class="command-group">
                    <div class="group-title">Machine Learning</div>
                    <div class="command">
                        <span class="command-syntax">scikit-learn</span>
                        <span class="command-description">Machine learning algorithms</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">xgboost</span>
                        <span class="command-description">Gradient boosting framework</span>
                    </div>
                </div>

                <div class="command-group">
                    <div class="group-title">Visualization</div>
                    <div class="command">
                        <span class="command-syntax">matplotlib</span>
                        <span class="command-description">Basic plotting library</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">seaborn</span>
                        <span class="command-description">Statistical data visualization</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">plotly</span>
                        <span class="command-description">Interactive visualizations</span>
                    </div>
                </div>

                <div class="command-group">
                    <div class="group-title">Web & APIs</div>
                    <div class="command">
                        <span class="command-syntax">requests</span>
                        <span class="command-description">HTTP library for API calls</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">urllib</span>
                        <span class="command-description">URL handling modules</span>
                    </div>
                </div>

                <div class="tip">
                    <strong>Tip:</strong> Use <code>help(library)</code> to see available functions for any imported library.
                </div>
            </div>
        </div>

        <!-- Business Examples -->
        <div class="section">
            <div class="section-header">Business Applications</div>
            <div class="section-content">
                <div class="workflow">
                    <div class="workflow-title">Sales Forecasting</div>
                    <ol>
                        <li>Import historical sales data with xl()</li>
                        <li>Clean and prepare data with pandas</li>
                        <li>Apply linear regression model</li>
                        <li>Generate forecast for next quarters</li>
                        <li>Create visualization with trends</li>
                    </ol>
                </div>

                <div class="example">
                    <div class="example-title">API Data Integration</div>
                    <div class="code-block">
<code>=PY(
import requests
import pandas as pd

# Fetch live data from API
response = requests.get('https://api.example.com/data')
api_data = response.json()

# Convert to DataFrame
df = pd.DataFrame(api_data)
df['timestamp'] = pd.to_datetime(df['timestamp'])
df.head()
)</code>
                    </div>
                </div>

                <div class="workflow">
                    <div class="workflow-title">Financial Dashboard</div>
                    <ol>
                        <li>Import financial data from multiple sheets</li>
                        <li>Calculate KPIs and ratios</li>
                        <li>Create interactive charts</li>
                        <li>Build automated summary tables</li>
                        <li>Set up dynamic date filtering</li>
                    </ol>
                </div>

                <div class="example">
                    <div class="example-title">Customer Segmentation</div>
                    <div class="code-block">
<code>=PY(
from sklearn.cluster import KMeans
import pandas as pd

# Load customer data
customers = xl("A1:E1000", headers=True)

# Prepare features for clustering
features = customers[['Age', 'Income', 'Spending']]

# Apply K-means clustering
kmeans = KMeans(n_clusters=3)
customers['Segment'] = kmeans.fit_predict(features)

# Return segmented data
customers
)</code>
                    </div>
                </div>
            </div>
        </div>

        <!-- Error Handling -->
        <div class="section">
            <div class="section-header">Error Handling & Troubleshooting</div>
            <div class="section-content">
                <div class="command-group">
                    <div class="group-title">Common Errors</div>
                    <div class="command">
                        <span class="command-syntax">ModuleNotFoundError</span>
                        <span class="command-description">Library not available in Python for Excel</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">ConnectionError</span>
                        <span class="command-description">Internet connection required for execution</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">ValueError</span>
                        <span class="command-description">Invalid data type or format</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">KeyError</span>
                        <span class="command-description">Column or key doesn't exist</span>
                    </div>
                </div>

                <div class="command-group">
                    <div class="group-title">Debug Techniques</div>
                    <div class="command">
                        <span class="command-syntax">print(variable)</span>
                        <span class="command-description">Display variable value</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">type(variable)</span>
                        <span class="command-description">Check data type</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">df.dtypes</span>
                        <span class="command-description">Check DataFrame column types</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">len(data)</span>
                        <span class="command-description">Check data length</span>
                    </div>
                </div>

                <div class="warning">
                    <strong>Limitation:</strong> Python execution requires internet connection. Save work frequently as cloud execution may timeout.
                </div>

                <div class="example">
                    <div class="example-title">Error Handling Example</div>
                    <div class="code-block">
<code>=PY(
try:
    data = xl("A1:C100", headers=True)
    result = data.groupby('Category').sum()
    result
except KeyError as e:
    print(f"Column not found: {e}")
except Exception as e:
    print(f"Error: {e}")
)</code>
                    </div>
                </div>
            </div>
        </div>

        <!-- Advanced Data Import -->
        <div class="section">
            <div class="section-header">Advanced Data Import</div>
            <div class="section-content">
                <div class="command-group">
                    <div class="group-title">Multiple Sheets</div>
                    <div class="command">
                        <span class="command-syntax">xl("Sheet1!A1:C10")</span>
                        <span class="command-description">Specific sheet reference</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">xl("Data!A:C")</span>
                        <span class="command-description">Entire columns from named sheet</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">xl("Summary!$A$1:$C$10")</span>
                        <span class="command-description">Absolute references</span>
                    </div>
                </div>

                <div class="command-group">
                    <div class="group-title">Dynamic Ranges</div>
                    <div class="command">
                        <span class="command-syntax">xl("A1").expand('table')</span>
                        <span class="command-description">Auto-detect data range</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">xl("MyTable")</span>
                        <span class="command-description">Named table reference</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">xl("DataRange")</span>
                        <span class="command-description">Named range reference</span>
                    </div>
                </div>

                <div class="example">
                    <div class="example-title">Multi-Sheet Analysis</div>
                    <div class="code-block">
<code>=PY(
import pandas as pd

# Combine data from multiple sheets
q1_data = xl("Q1!A1:E100", headers=True)
q2_data = xl("Q2!A1:E100", headers=True)
q3_data = xl("Q3!A1:E100", headers=True)

# Concatenate quarterly data
yearly_data = pd.concat([q1_data, q2_data, q3_data])
yearly_summary = yearly_data.groupby('Region').sum()
yearly_summary
)</code>
                    </div>
                </div>
            </div>
        </div>

        <!-- Machine Learning -->
        <div class="section">
            <div class="section-header">Machine Learning</div>
            <div class="section-content">
                <div class="command-group">
                    <div class="group-title">Model Training</div>
                    <div class="command">
                        <span class="command-syntax">LinearRegression()</span>
                        <span class="command-description">Linear regression model</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">RandomForestRegressor()</span>
                        <span class="command-description">Random forest for regression</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">KMeans(n_clusters=3)</span>
                        <span class="command-description">K-means clustering</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">train_test_split()</span>
                        <span class="command-description">Split data for training/testing</span>
                    </div>
                </div>

                <div class="command-group">
                    <div class="group-title">Model Evaluation</div>
                    <div class="command">
                        <span class="command-syntax">mean_squared_error()</span>
                        <span class="command-description">Calculate MSE</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">r2_score()</span>
                        <span class="command-description">R-squared coefficient</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">classification_report()</span>
                        <span class="command-description">Classification metrics</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">confusion_matrix()</span>
                        <span class="command-description">Confusion matrix</span>
                    </div>
                </div>

                <div class="example">
                    <div class="example-title">Sales Prediction Model</div>
                    <div class="code-block">
<code>=PY(
from sklearn.linear_model import LinearRegression
from sklearn.model_selection import train_test_split
from sklearn.metrics import mean_squared_error, r2_score

# Load and prepare data
data = xl("A1:F1000", headers=True)
X = data[['Advertising', 'Price', 'Competition']]
y = data['Sales']

# Split data
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2)

# Train model
model = LinearRegression()
model.fit(X_train, y_train)

# Make predictions
predictions = model.predict(X_test)

# Evaluate
r2 = r2_score(y_test, predictions)
print(f"R¬≤ Score: {r2:.3f}")
predictions
)</code>
                    </div>
                </div>
            </div>
        </div>

        <!-- Financial Analysis -->
        <div class="section">
            <div class="section-header">Financial Analysis</div>
            <div class="section-content">
                <div class="command-group">
                    <div class="group-title">Time Value of Money</div>
                    <div class="command">
                        <span class="command-syntax">np.pv(rate, nper, pmt)</span>
                        <span class="command-description">Present value calculation</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">np.fv(rate, nper, pmt, pv)</span>
                        <span class="command-description">Future value calculation</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">np.npv(rate, values)</span>
                        <span class="command-description">Net present value</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">np.irr(values)</span>
                        <span class="command-description">Internal rate of return</span>
                    </div>
                </div>

                <div class="command-group">
                    <div class="group-title">Risk Analysis</div>
                    <div class="command">
                        <span class="command-syntax">np.random.normal()</span>
                        <span class="command-description">Monte Carlo simulation</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">df.rolling().std()</span>
                        <span class="command-description">Rolling volatility</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">np.percentile(data, 5)</span>
                        <span class="command-description">Value at Risk (VaR)</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">scipy.stats.jarque_bera()</span>
                        <span class="command-description">Normality test</span>
                    </div>
                </div>

                <div class="example">
                    <div class="example-title">Portfolio Risk Analysis</div>
                    <div class="code-block">
<code>=PY(
import numpy as np
import pandas as pd

# Load portfolio returns
returns = xl("A1:E252", headers=True)
portfolio_weights = [0.3, 0.25, 0.2, 0.15, 0.1]

# Calculate portfolio returns
portfolio_returns = (returns * portfolio_weights).sum(axis=1)

# Risk metrics
annual_return = portfolio_returns.mean() * 252
annual_volatility = portfolio_returns.std() * np.sqrt(252)
sharpe_ratio = annual_return / annual_volatility

# VaR calculation
var_95 = np.percentile(portfolio_returns, 5)

print(f"Annual Return: {annual_return:.2%}")
print(f"Volatility: {annual_volatility:.2%}")
print(f"Sharpe Ratio: {sharpe_ratio:.3f}")
print(f"VaR (95%): {var_95:.3%}")
)</code>
                    </div>
                </div>
            </div>
        </div>

        <!-- API Integration -->
        <div class="section">
            <div class="section-header">API & Web Data</div>
            <div class="section-content">
                <div class="command-group">
                    <div class="group-title">HTTP Requests</div>
                    <div class="command">
                        <span class="command-syntax">requests.get(url)</span>
                        <span class="command-description">GET request</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">requests.post(url, data)</span>
                        <span class="command-description">POST request</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">response.json()</span>
                        <span class="command-description">Parse JSON response</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">response.status_code</span>
                        <span class="command-description">Check response status</span>
                    </div>
                </div>

                <div class="command-group">
                    <div class="group-title">Authentication</div>
                    <div class="command">
                        <span class="command-syntax">headers={'Authorization': 'Bearer token'}</span>
                        <span class="command-description">Bearer token auth</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">auth=('user', 'pass')</span>
                        <span class="command-description">Basic authentication</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">params={'api_key': 'key'}</span>
                        <span class="command-description">API key parameter</span>
                    </div>
                </div>

                <div class="example">
                    <div class="example-title">Stock Price API</div>
                    <div class="code-block">
<code>=PY(
import requests
import pandas as pd

# Fetch stock data from API
url = "https://api.example.com/stock/AAPL"
headers = {'Authorization': 'Bearer YOUR_TOKEN'}

response = requests.get(url, headers=headers)
data = response.json()

# Convert to DataFrame
df = pd.DataFrame(data['prices'])
df['date'] = pd.to_datetime(df['date'])
df = df.sort_values('date')

# Calculate moving averages
df['MA_20'] = df['close'].rolling(20).mean()
df['MA_50'] = df['close'].rolling(50).mean()

df.tail(10)
)</code>
                    </div>
                </div>
            </div>
        </div>

        <!-- Performance Optimization -->
        <div class="section">
            <div class="section-header">Performance & Best Practices</div>
            <div class="section-content">
                <div class="command-group">
                    <div class="group-title">Memory Management</div>
                    <div class="command">
                        <span class="command-syntax">df.memory_usage()</span>
                        <span class="command-description">Check memory usage</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">pd.read_csv(chunksize=1000)</span>
                        <span class="command-description">Process in chunks</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">df.astype('category')</span>
                        <span class="command-description">Optimize data types</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">del variable</span>
                        <span class="command-description">Free memory</span>
                    </div>
                </div>

                <div class="command-group">
                    <div class="group-title">Vectorization</div>
                    <div class="command">
                        <span class="command-syntax">df['col'] * 2</span>
                        <span class="command-description">Vectorized operations</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">np.where(condition, x, y)</span>
                        <span class="command-description">Conditional operations</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">df.apply(func)</span>
                        <span class="command-description">Apply function to series</span>
                    </div>
                    <div class="command">
                        <span class="command-syntax">df.map(mapping)</span>
                        <span class="command-description">Map values efficiently</span>
                    </div>
                </div>

                <div class="tip">
                    <strong>Performance Tip:</strong> Use vectorized operations instead of loops. Process data in chunks for large datasets to avoid memory issues.
                </div>

                <div class="warning">
                    <strong>Cloud Limits:</strong> Python execution has timeout limits. Break complex operations into smaller cells for better reliability.
                </div>
            </div>
        </div>